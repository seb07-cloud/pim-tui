---
phase: 02-codebase-cleanup
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - internal/ui/views.go
  - internal/azure/groups.go
  - internal/azure/lighthouse.go
autonomous: true

must_haves:
  truths:
    - "No unused functions exist in codebase"
    - "All API errors are logged (no silent swallowing)"
    - "Code passes go vet without warnings"
  artifacts:
    - path: "internal/ui/views.go"
      provides: "Clean view code without dead functions"
    - path: "internal/azure/groups.go"
      provides: "Error logging for group name lookup failures"
    - path: "internal/azure/lighthouse.go"
      provides: "Debug logging for active assignments query failures"
  key_links:
    - from: "getGroupName error"
      to: "debug log output"
      via: "fmt.Errorf or similar"
    - from: "active assignments error"
      to: "debug log or comment"
      via: "explicit handling"
---

<objective>
Remove dead code and improve error handling consistency across the codebase.

Purpose: Clean up technical debt, ensure no silent error swallowing, establish consistent patterns for future development.
Output: Clean codebase with no dead code and proper error logging.
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/codebase/CONCERNS.md
@.planning/codebase/CONVENTIONS.md

@internal/ui/views.go
@internal/azure/groups.go
@internal/azure/lighthouse.go
</context>

<tasks>

<task type="auto">
  <name>Task 1: Remove spinnerPulse dead code</name>
  <files>internal/ui/views.go</files>
  <action>
    1. Delete the `spinnerPulse` function (lines 1409-1414)
    2. Delete the accompanying comment on line 1409
    3. The function is confirmed unused - no callers exist in codebase

    The function to remove:
    ```go
    // spinnerPulse provides a pulsing effect for waiting states
    func spinnerPulse(color lipgloss.Color) string {
        chars := []string{"○", "◔", "◑", "◕", "●", "◕", "◑", "◔"}
        idx := int(time.Now().UnixMilli()/150) % len(chars)
        return lipgloss.NewStyle().Foreground(color).Render(chars[idx])
    }
    ```

    Keep `spinner` and `spinnerDots` - they ARE used.
  </action>
  <verify>go build ./... succeeds, grep "spinnerPulse" internal/ returns no matches</verify>
  <done>Dead spinnerPulse function removed from codebase</done>
</task>

<task type="auto">
  <name>Task 2: Add error logging for silently ignored errors</name>
  <files>internal/azure/groups.go, internal/azure/lighthouse.go</files>
  <action>
    **In groups.go line 74:**
    The error from `getGroupName` is currently discarded with `_`:
    ```go
    if name, _ := c.getGroupName(ctx, id); name != "" {
    ```

    This is acceptable behavior (fallback to ID if name lookup fails), but we should document WHY the error is ignored. Add a comment:
    ```go
    // Error intentionally ignored - we fall back to using the group ID as display name
    if name, err := c.getGroupName(ctx, id); err == nil && name != "" {
    ```

    This makes it explicit and uses proper error checking pattern.

    **In lighthouse.go lines 317-348:**
    The active assignments query errors are already documented with a comment on line 347-348:
    ```go
    // Note: errors from active assignments query are silently ignored
    // because this is an enhancement - eligible roles are still returned
    ```

    This is acceptable - the comment explains the reasoning. No change needed here.
  </action>
  <verify>go build ./... succeeds</verify>
  <done>Error handling is explicit with clear documentation for intentionally ignored errors</done>
</task>

<task type="auto">
  <name>Task 3: Run go vet and fix any warnings</name>
  <files>internal/ui/views.go, internal/azure/groups.go, internal/azure/lighthouse.go</files>
  <action>
    1. Run `go vet ./...` to check for common issues
    2. Fix any warnings found
    3. Run `go build ./...` to confirm no build issues

    Expected: No warnings after the cleanup. If any exist, fix them.
  </action>
  <verify>go vet ./... returns no warnings, go build ./... succeeds</verify>
  <done>Codebase passes go vet with no warnings</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `go build ./...` succeeds
- [ ] `go vet ./...` passes with no warnings
- [ ] `grep -r "spinnerPulse" internal/` returns no matches
- [ ] Error handling in groups.go is explicit (not using `_` for error)
- [ ] No new functionality added (this is cleanup only)
</verification>

<success_criteria>
- All tasks completed
- Dead code removed (spinnerPulse)
- Error handling explicit where previously silent
- Build and vet pass with no issues
</success_criteria>

<output>
After completion, create `.planning/phases/02-codebase-cleanup/02-01-SUMMARY.md`
</output>
